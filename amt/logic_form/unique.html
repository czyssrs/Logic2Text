<!-- You must include this JavaScript file -->
<script src="https://assets.crowd.aws/crowd-html-elements.js"></script>

<!-- For the full list of available Crowd HTML Elements and their input/output documentation,
      please refer to https://docs.aws.amazon.com/sagemaker/latest/dg/sms-ui-template-reference.html -->

<!-- You must include crowd-form so that your task submits answers to MTurk -->
<crowd-form answer-format="flatten-objects">
    
<meta content="width=device-width,initial-scale=1" name="viewport" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<section class="container" id="Survey"><!-- Instructions -->
<div class="row">
<div class="col-xs-12 col-md-12">
<div class="panel panel-primary">

<a class="panel-heading" href="javascript:void(0);" id="collapseTrigger"><strong>Survey Instructions</strong> <span class="collapse-text">(Click to expand)</span> </a>

<div class="panel-body" id="instructionBody">
    <p> <strong>You are given a table with its title and its wikipedia source, and a <strong>statement about the uniqueness of one table row</strong>, your job is to annotate the semantic meaning of this statement following 6 steps: </strong><br>

<br>
    1. What is the scope of this statement describing unique row? <br>
    2. What is this unique row? <br>
    3. Write the table column that shows the uniqueness of this row <br>
    4. Select the criterion, based on which we filter records in this column to find the unique row. Here we consider the following criterion: <strong>"equal", "not equal", "less than", "greater than", "fuzzily match" </strong>(or "other" if none of the above is correct). <br>
    5. Based on the selected criterion, write the value to be filtered for the unqiue row. <br>
    6. On this unique row, what are the other column(s) mentioned (except the column describing the scope)? If not any other column is mentioned, write 'n/a'. <br>
<br>

We list some examples below to help you understand. <strong>Please carefully read and study these examples before starting. </strong> <strong>We pad the table column and row numbers around the table (blue part) to help you annotate. </strong>For column and row selection, the format is the col/row numbers seperated by comma (e.g., 1,2,3). 
</p>
<div class="panel panel-default" class="col-lg-12">
<div class="panel-heading"> Table Wikipedia Link: <a href="https://en.wikipedia.org/wiki/1996%E2%80%9397_Atlanta_Hawks_season">1996 - 97 atlanta hawks season</a> </div>

<div class="row">
    <div class="panel-body" id="instructionBody">
        <div class="col-lg-6">
            <table class='wikitable'>
              <tr><td id="HEADER"></td><td id="HEADER">1</td><td id="HEADER">2</td><td id="HEADER">3</td><td id="HEADER">4</td><td id="HEADER">5</td><td id="HEADER">6</td></tr>
              <tr><td id="HEADER"></td><th>game</th><th>date</th><th>opponent</th><th>score</th><th>location</th><th>attendence</th></tr>
              <tr><td id="HEADER">1</td><td>73</td><td>april 2</td><td>charlotte hornets</td><td>l 84 - 95</td><td>charlotte coliseum</td><td>24042</td></tr>
              <tr><td id="HEADER">2</td><td>74</td><td>april 4</td><td>detroit pistons</td><td>w 103 - 89</td><td>omni coliseum</td><td>16378</td></tr>
              <tr><td id="HEADER">3</td><td>75</td><td>april 5</td><td>new york knicks</td><td>l 97 - 102</td><td>omni coliseum</td><td>16378</td></tr>
              <tr><td id="HEADER">4</td><td>76</td><td>april 9</td><td>philadelphia 76ers</td><td>w 116 - 101</td><td>corestates center</td><td>16549</td></tr>
              <tr><td id="HEADER">5</td><td>77</td><td>april 11</td><td>indiana pacers</td><td>w 104 - 92</td><td>market square arena</td><td>16403</td></tr>
              <tr><td id="HEADER">6</td><td>78</td><td>april 12</td><td>minnesota timberwolves</td><td>w 80 - 66</td><td>target center</td><td>18874</td></tr>
              <tr><td id="HEADER">7</td><td>79</td><td>april 15</td><td>new jersey nets</td><td>w 109 - 101</td><td>omni coliseum</td><td>14458</td></tr>
              <tr><td id="HEADER">8</td><td>80</td><td>april 16</td><td>new york knicks</td><td>l 92 - 96</td><td>madison square garden</td><td>19763</td></tr>
              <tr><td id="HEADER">9</td><td>81</td><td>april 19</td><td>philadelphia 76ers</td><td>w 136 - 104</td><td>omni coliseum</td><td>16457</td></tr>
              <tr><td id="HEADER">10</td><td>82</td><td>april 20</td><td>new jersey nets</td><td>l 92 - 108 (ot)</td><td>continental airlines arena</td><td>18702</td></tr></table>
        </div>

        <div class="col-lg-6">
            <strong>Accepted examples</strong>: <br><br>

            <font color="green">Example 1</font><br>
            <strong>Statement: </strong> in the 96'-97' season of atlanta hawks, the game on april 15 is the only one held in omni coliseum with less than 16000 fans attended. <br><br>

            <strong>1. What is the scope of this statement describing unique row? </strong><br>
            <strong>Your Answer:</strong> a subset of rows <br>

            <strong>2. What is this unique row? </strong><br>
            <strong>Your Answer:</strong> 7 <br>

            <strong>3. Write the table column that shows the uniqueness of this row</strong><br>
            <strong>Your Answer:</strong> 6 <br>

            <strong>4. Select the criterion, based on which we filter records in this column to find the unique row. </strong><br>
            <strong>Your Answer:</strong> less than <br>

            <strong>5. Based on the selected criterion, write the value to be filtered for the unqiue row. </strong><br>
            <strong>Your Answer:</strong> 16000 <br>

            <strong>6. On this unique row, what are the other column(s) mentioned (except the column describing the scope)? If not any other column is mentioned, write 'n/a'.</strong><br>
            <strong>Your Answer:</strong> 2 <br>

            ( Explain: this statement is talking about the 7th row, the only one among the subset of rows whose "location" is "omni coliseum", that has an attendance less than 16000 thus the scope should be "a subset of rows". the statement also mentioned the date (column 2) of this row, therefore we select column 2 for question 6. Note that for question 6 we do not include the column for describing the scope, e.g., not include column 5 for this case.) <br><br>
            <br>


            <font color="green">Example 2</font><br>
            <strong>Statement: </strong> in the 96'-97' season of atlanta hawks, the game on april 12 is the only one held in target center. <br><br>

            <strong>1. What is the scope of this statement describing unique row? </strong><br>
            <strong>Your Answer:</strong> all rows <br>

            <strong>2. What is this unique row? </strong><br>
            <strong>Your Answer:</strong> 6 <br>

            <strong>3. Write the table column that shows the uniqueness of this row</strong><br>
            <strong>Your Answer:</strong> 5 <br>

            <strong>4. Select the criterion, based on which we filter records in this column to find the unique row. </strong><br>
            <strong>Your Answer:</strong> equal <br>

            <strong>5. Based on the selected criterion, write the value to be filtered for the unqiue row. </strong><br>
            <strong>Your Answer:</strong> target center <br>

            <strong>6. On this unique row, what are the other column(s) mentioned (except the column describing the scope)? If not any other column is mentioned, write 'n/a'.</strong><br>
            <strong>Your Answer:</strong> 2 <br>

            ( Explain: this statement is talking about the 6th row, the only one among all rows whose "location" column (column 6) is "target center". thus the scope should be "all rows". the statement also mentioned the date (column 2) of this row, therefore we select column 2 for question 6) <br><br>
            <br>


            <font color="green">Example 3</font><br>
            <strong>Statement: </strong> in the 96'-97' season of atlanta hawks, the game against new jersey nets was the only one that wents overtime (otï¼‰. <br><br>

            <strong>1. What is the scope of this statement describing unique row? </strong><br>
            <strong>Your Answer:</strong> all rows <br>

            <strong>2. What is this unique row? </strong><br>
            <strong>Your Answer:</strong> 10 <br>

            <strong>3. Write the table column that shows the uniqueness of this row</strong><br>
            <strong>Your Answer:</strong> 4 <br>

            <strong>4. Select the criterion, based on which we filter records in this column to find the unique row. </strong><br>
            <strong>Your Answer:</strong> fuzzily match <br>

            <strong>5. Based on the selected criterion, write the value to be filtered for the unqiue row. </strong><br>
            <strong>Your Answer:</strong> ot <br>

            <strong>6. On this unique row, what are the other column(s) mentioned (except the column describing the scope)? If not any other column is mentioned, write 'n/a'.</strong><br>
            <strong>Your Answer:</strong> 3 <br>

            ( Explain: he criterion "fuzzily match" works for the case where the value is not a exact match of table records, but fuzzily matches to them, for example, a substring "ot" in the records in this case. Here this statement also mentions the opposing team "new jersey nets", therefore we select column 3 for the last question) <br><br>



        </div>
    </div>
</div>
</div>
<p>
  <strong>NOTE: 
    1. The criterion is based on the numerical value of table records, not the one expressed in the statement. For example, "player 1 is the only one ranked higher than 3rd", then the rank of player 1 should be numerically smaller than 3 and we choose "less than" for question 4. <br><br>

    2. If there are any errors in the given statement, or the given statement cannot be interpreted using the above formula, just leave the selection slots unselected and write 'n/a' in all other slots. </strong>
</p>


</div>
</div>

<div class="row" id="workContent">
<div class="col-sm-12 col-sm-offset-0">
<div class="panel panel-default" style="width: 100%;">
    
<div class="panel-heading">
    If you have not study all the above examples carefully, or feel not very clear about the task, do not start doing this task -- you will be probably rejected. <br><br>
    First read the following table, then annotate the semantic meaning of the statement:
</div>

<div class="panel-body">
Table Source: <a href=${wiki1}>${topic1}</a><br>
Table title: ${topic1}
<div id="url1">${url1}</div><br>
<br>
<strong>Statement: ${sent1}</strong>
<br>
<br>
  <p>1. What is the scope of this statement describing unique row? </p>
  <select name="scope">
      <option value="tmp1">-- click to select --</option>
      <option value="all">all rows</option>
      <option value="subset">a subset of rows</option>
      </select>
      </p>
  <br>
  <p>2. What is this unique row? </p>
    <textarea name="row_unique" class="form-control" rows="1" type="text" placeholder="write row number" required></textarea><br>
    <br>
  <p>3. Write the table column that shows the uniqueness of this row </p>
    <textarea name="col" class="form-control" rows="1" type="text" placeholder="write column number" required></textarea><br>
    <br>
  <p>4. Select the criterion, based on which we filter records in this column to find the unique row. </p>
  <select name="criterion">
      <option value="tmp1">-- click to select --</option>
      <option value="equal">equal</option>
      <option value="not_equal">not equal</option>
      <option value="greater_than">greater than</option>
      <option value="less_than">less than</option>
      <option value="fuzzily_match">fuzzily match</option>
      <option value="other">other</option>
      </select>
      </p>
  <br>
  <p>5. Based on the selected criterion, write the value to be filtered for the unqiue row. </p>
    <textarea name="value" class="form-control" rows="1" type="text" placeholder="write value" required></textarea><br>
    <br>
  <p>6. On this unique row, what are the other column(s) mentioned (except the column describing the scope)? If not any other column is mentioned, write 'n/a'. </p>
    <textarea name="col_other" class="form-control" rows="1" type="text" placeholder="write column number" required></textarea><br>
    <br>
</div>


</div>
</div>
</div>

</div>
</div>
</section>

<script type="text/javascript">
jQuery.ajaxSetup({async:false});
$(document).ready(function(){
    var table_content = "";
    var cur = $(`#url1`).text()
    $.get(cur, function(data){
        var nwe_data = CSV2Table(data);
        table_content += nwe_data;
    }, 'text').fail(function() {
    });
    $(`#url1`).html(table_content);
    
    $('a').each(function(i, val){
    if(val.href.match(/wikipedia/g))
        val.target="_blank";
    else
        val.href = "javascript:void(0)"
    });

    var tabtrigger = $('#collapseTrigger');
    var tabcontent = $('#instructionBody');

    $('.collapse-text').text('(Click to expand)');
    tabtrigger.click(function(){
      tabcontent.toggle();
      var isVisible = tabcontent.is(':visible');
      if(isVisible){
        $('.collapse-text').text('(Click to collapse)');
      }else{
        $('.collapse-text').text('(Click to expand)');
      }
    });

});
    
function CSV2Table(data) {
    var lines = data.split("\n");
    lines.pop();
    //var headers = lines[0].split(separator);
    var output = []

    var column = "<tr><td id=\"HEADER\"></td>"
    for (i = 0; i < lines[0].slice(0,-1).split("#").length; i++){
      this_i = i + 1
      column += "<td id=\"HEADER\">" + this_i + "</td>";
    }
    column += "</tr>"
    output.push(column);

    for (i = 0; i < lines.length; i++){
        //var fields = lines[i].split("#");
        // add padding
        if(i == 0){
            output.push("<tr><td id=\"HEADER\"></td><th>" + lines[i].slice(0,-1).split("#").join("</th><th>") + "</th></tr>");
        }
        else{
            output.push("<tr><td id=\"HEADER\">" + i + "</td><td>" + lines[i].slice(0,-1).split("#").join("</td><td>") + "</td></tr>");
        }
        // if(i == 0){
        //     output.push("<tr><th>" + lines[i].slice(0,-1).split("#").join("</th><th>") + "</th></tr>");
        // }
        // else{
        //     output.push("<tr><td>" + lines[i].slice(0,-1).split("#").join("</td><td>") + "</td></tr>");            
        // }
    }
    output = "<table class='wikitable'>" + output.join("") + "</table>";
    return output
}
</script>

<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" integrity="sha384-IS73LIqjtYesmURkDE9MXKbXqYA8rvKEp/ghicjem7Vc3mGRdQRptJSz60tvrB6+" rel="stylesheet" />
<style type="text/css">#collapseTrigger{ color:#fff; display: block; text-decoration: none; } #submitButton{ white-space: normal; } .image{ margin-bottom: 15px; }
</style>
        <style>
            table, tr {
                border: 1px solid black;
                padding: 5px;
                color: black;
                font-family: verdana;
                background-color: lightyellow;
                font-size: smaller;
            }

            td#HEADER  {background-color: lightblue;}

            th {
                border: 1px solid black;
                padding: 5px;
                color: black;
                font-family: verdana;
                font-size: smaller;
            }
            td {
                border: 1px solid black;
                padding: 5px;
                color: black;
                font-family: verdana;
                background-color: #F7F8FA;
                font-size: smaller;
            }
            .panel {
                display: inline-block;
                background: white;
            }
            p {
              display: block;
              margin-top: 0em;
              margin-bottom: 1em;
              margin-left: 1em;
              margin-right: 1em;
            }
</style>
